create or replace FUNCTION "UFN_STC_ALARM_INFO_GET" 
    RETURN SYS_REFCURSOR 
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_ALARM_INFO.ALARM_ID, TMP_ALARM_INFO.ALARM_NM, TMP_ALARM_INFO.LIGHTALARM_GB, 
        TMP_ALARM_INFO.MODULE_NM, TMP_ALARM_INFO.DESC_NM_KOR, TMP_ALARM_INFO.SOLUTION_NM_KOR,
        TMP_ALARM_INFO.DESC_NM_ENG, TMP_ALARM_INFO.SOLUTION_NM_ENG, TMP_ALARM_INFO.DESC_NM_CHN, TMP_ALARM_INFO.SOLUTION_NM_CHN,
        TMP_ALARM_INFO.DESC_NM_HUN, TMP_ALARM_INFO.SOLUTION_NM_HUN
        FROM TB_ALARM_INFO TMP_ALARM_INFO ORDER BY TMP_ALARM_INFO.ALARM_ID ASC;
    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_ALARM_INFO_GET;

/

create or replace FUNCTION "UFN_STC_CARRIER_INFO_GET" 
(
    P_SCS_CD    IN NVARCHAR2
)
    RETURN SYS_REFCURSOR
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_CARRIER_INFO.CARRIER_ID, TMP_CARRIER_INFO.CARRIER_LOC, TMP_CARRIER_INFO.PRODUCT_STAT, TMP_CARRIER_INFO.POLARITY_STAT, 
        TMP_CARRIER_INFO.WINDERDIR_STAT, TMP_CARRIER_INFO.PRODUCT_CNT, TMP_CARRIER_INFO.FINALLOC_NO, TMP_CARRIER_INFO.INNERTYPE_GB, 
        TMP_CARRIER_INFO.PALLET_GB, TMP_CARRIER_INFO.TRAYSTACK_CNT, TMP_CARRIER_INFO.TRAYTYPE_STAT, TMP_CARRIER_INFO.UNCOATED_STAT,
        TMP_CARRIER_INFO.CORETYPE_STAT, TMP_CARRIER_INFO.VALIDATION_ID, TMP_CARRIER_INFO.PRODUCTEND_STAT, TMP_CARRIER_INFO.CARRIER_CD, 
        TMP_CARRIER_INFO.CARRIER_GB, TMP_CARRIER_INFO.CARRIER_STAT, TMP_CARRIER_INFO.LOT_ID, TMP_CARRIER_INFO.FIRSTLOT_ID,
        TMP_CARRIER_INFO.SECONDLOT_ID, TMP_CARRIER_INFO.THIRDLOT_ID, TMP_CARRIER_INFO.FOURTHLOT_ID, TMP_CARRIER_INFO.FIFTHLOT_ID, 
        TMP_CARRIER_INFO.SIXTHLOT_ID, TMP_CARRIER_INFO.CARRYIN_DTTM, TMP_CARRIER_INFO.CARRYOUT_DTTM, TMP_CARRIER_INFO.CARRIERID_STAT,
        TMP_CARRIER_INFO.CARRIERHEIGHT_STAT
        FROM TB_CARRIER_INFO TMP_CARRIER_INFO WHERE TMP_CARRIER_INFO.SCS_CD=P_SCS_CD;

    RETURN TMP_DATA;
    CLOSE TMP_DATA;

END UFN_STC_CARRIER_INFO_GET;


/

create or replace FUNCTION "UFN_STC_CLIENT_ORDER_GET" 
(
    P_SCS_CD        IN NVARCHAR2,
    P_REQUESTER_GB  IN CHAR,
    P_CLIENT_CD     IN NVARCHAR2
)
    RETURN SYS_REFCURSOR
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    IF P_CLIENT_CD IS NULL THEN
        OPEN TMP_DATA FOR
        SELECT TMP_CLIENT_ORDER.CMD_GB, TMP_CLIENT_ORDER.TARGET_CD, TMP_CLIENT_ORDER.TARGET_ID, 
            TMP_CLIENT_ORDER.TARGET_VALUE, TMP_CLIENT_ORDER.CREATE_DTTM, TMP_CLIENT_ORDER.REQUESTER_GB,
            TMP_CLIENT_ORDER.JOB_ID, TMP_CLIENT_ORDER.SCS_CD, TMP_CLIENT_ORDER.CLIENT_CD
            FROM TB_CLIENT_ORDER TMP_CLIENT_ORDER 
            WHERE TMP_CLIENT_ORDER.SCS_CD=P_SCS_CD AND TMP_CLIENT_ORDER.REQUESTER_GB=P_REQUESTER_GB 
            ORDER BY TMP_CLIENT_ORDER.CREATE_DTTM ASC;
        RETURN TMP_DATA;
        CLOSE TMP_DATA;
    ELSE
        OPEN TMP_DATA FOR
        SELECT TMP_CLIENT_ORDER.CMD_GB, TMP_CLIENT_ORDER.TARGET_CD, TMP_CLIENT_ORDER.TARGET_ID, 
            TMP_CLIENT_ORDER.TARGET_VALUE, TMP_CLIENT_ORDER.CREATE_DTTM, TMP_CLIENT_ORDER.REQUESTER_GB,
            TMP_CLIENT_ORDER.JOB_ID, TMP_CLIENT_ORDER.SCS_CD, TMP_CLIENT_ORDER.CLIENT_CD
            FROM TB_CLIENT_ORDER TMP_CLIENT_ORDER 
            WHERE TMP_CLIENT_ORDER.SCS_CD=P_SCS_CD AND TMP_CLIENT_ORDER.REQUESTER_GB=P_REQUESTER_GB AND TMP_CLIENT_ORDER.CLIENT_CD=P_CLIENT_CD
            ORDER BY TMP_CLIENT_ORDER.CREATE_DTTM ASC;
        RETURN TMP_DATA;
        CLOSE TMP_DATA;    
    END IF;
END UFN_STC_CLIENT_ORDER_GET;

/

create or replace FUNCTION "UFN_STC_CONFIG_INFO_GET" 
(
    P_SCS_CD        IN NVARCHAR2,
    P_CONFIG_GB     IN NVARCHAR2,
    P_CONFIG_NM     IN NVARCHAR2,
    P_CONFIG_ALL    IN CHAR
)
    RETURN SYS_REFCURSOR
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    IF P_CONFIG_NM IS NULL AND P_CONFIG_ALL ='0' AND P_CONFIG_GB IS NOT NULL THEN
        OPEN TMP_DATA FOR
        SELECT TMP_CONFIG_INFO.CONFIG_NM, TMP_CONFIG_INFO.CONFIG_VAL FROM TB_CONFIG_INFO TMP_CONFIG_INFO 
            WHERE TMP_CONFIG_INFO.SCS_CD=P_SCS_CD AND TMP_CONFIG_INFO.CONFIG_GB=P_CONFIG_GB;
    ELSIF P_CONFIG_ALL = '1' THEN
        OPEN TMP_DATA FOR
        SELECT TMP_CONFIG_INFO.CONFIG_NO, TMP_CONFIG_INFO.CONFIG_GB, TMP_CONFIG_INFO.CONFIG_NM, TMP_CONFIG_INFO.CONFIG_VAL, TMP_CONFIG_INFO.CONFIG_DEF, 
            TMP_CONFIG_INFO.CONFIG_DES FROM TB_CONFIG_INFO TMP_CONFIG_INFO 
            WHERE TMP_CONFIG_INFO.SCS_CD=P_SCS_CD AND TMP_CONFIG_INFO.CONFIG_NO > 0 ORDER BY TMP_CONFIG_INFO.CONFIG_NO ASC;
    ELSIF P_CONFIG_NM IS NULL AND P_CONFIG_ALL ='0' AND P_CONFIG_GB IS NULL THEN
        OPEN TMP_DATA FOR
        SELECT COUNT(TMP_CONFIG_INFO.CONFIG_NO) FROM TB_CONFIG_INFO TMP_CONFIG_INFO WHERE TMP_CONFIG_INFO.SCS_CD=P_SCS_CD AND TMP_CONFIG_INFO.CONFIG_NO > 0;
    ELSE
        OPEN TMP_DATA FOR
        SELECT TMP_CONFIG_INFO.CONFIG_VAL, TMP_CONFIG_INFO.CONFIG_NO FROM TB_CONFIG_INFO TMP_CONFIG_INFO 
            WHERE TMP_CONFIG_INFO.SCS_CD=P_SCS_CD AND TMP_CONFIG_INFO.CONFIG_GB=P_CONFIG_GB AND TMP_CONFIG_INFO.CONFIG_NM=P_CONFIG_NM;    
    END IF;

    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_CONFIG_INFO_GET;


/

create or replace FUNCTION "UFN_STC_CONNECT_CLIENT_GET" 
(
    P_SCS_CD    IN NVARCHAR2
)
    RETURN SYS_REFCURSOR 
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_CONNECT_CLIENT_INFO.SCS_CD, TMP_CONNECT_CLIENT_INFO.CLIENT_CD, TMP_CONNECT_CLIENT_INFO.CLIENT_IP
        FROM TB_CONNECT_CLIENT_INFO TMP_CONNECT_CLIENT_INFO WHERE TMP_CONNECT_CLIENT_INFO.SCS_CD=P_SCS_CD;
    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_CONNECT_CLIENT_GET;

/

create or replace FUNCTION "UFN_STC_EQP_INFO_GET" 
(
    P_SCS_CD        IN NVARCHAR2
)
    RETURN SYS_REFCURSOR    
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_EQP_INFO.EQP_NM, TMP_EQP_INFO.EQP_ID, TMP_EQP_INFO.EQP_NO, 
        TMP_EQP_INFO.MCS_STAT, TMP_EQP_INFO.SCS_STAT, TMP_EQP_INFO.PLC_STAT, 
        TMP_EQP_INFO.SYSTEM_STAT, TMP_EQP_INFO.IP_NO, 
        TMP_EQP_INFO.DBFIRSTIP_NO, TMP_EQP_INFO.DBFIRSTPORT_NO, TMP_EQP_INFO.DBFIRSTSERVICE_NM,
        TMP_EQP_INFO.DBSECONDIP_NO, TMP_EQP_INFO.DBSECONDPORT_NO, TMP_EQP_INFO.DBSECONDSERVICE_NM,
        TMP_EQP_INFO.DBACCOUNT_NM, TMP_EQP_INFO.DBPASSWORD_GB        
        FROM TB_EQP_INFO TMP_EQP_INFO;
    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_EQP_INFO_GET;

/

create or replace FUNCTION "UFN_STC_FIRE_INFO_GET" 
(
    P_SCS_CD    IN NVARCHAR2,
    P_RACK_CD   IN NVARCHAR2
)
    RETURN SYS_REFCURSOR   
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_FIRE_LOC_EMS.BANK, TMP_FIRE_LOC_EMS.BAY, TMP_FIRE_LOC_EMS.LVL, TMP_FIRE_LOC_EMS.EVENTINFO, TMP_FIRE_LOC_EMS.TEMPERATURE, 
        TMP_FIRE_LOC_EMS.SMOKESENSE, TMP_FIRE_LOC_EMS.WARN_TEMP, TMP_FIRE_LOC_EMS.DANGER_TEMP, TMP_FIRE_LOC_EMS.EVENTTIME
        FROM TB_FIRE_LOC_EMS TMP_FIRE_LOC_EMS WHERE TMP_FIRE_LOC_EMS.RACKTYPE = P_RACK_CD AND TMP_FIRE_LOC_EMS.SCS_CD = P_SCS_CD;
    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_FIRE_INFO_GET;


/

create or replace FUNCTION "UFN_STC_JOB_INFO_GET" 
(
    P_SCS_CD    IN NVARCHAR2
)
    RETURN SYS_REFCURSOR    
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_JOB_INFO.SCS_CD, TMP_JOB_INFO.CREATE_DTTM, TMP_JOB_INFO.CARRIER_ID, TMP_JOB_INFO.SOUR_ID, TMP_JOB_INFO.DEST_ID, 
        TMP_JOB_INFO.PRIORITY_ORDER, TMP_JOB_INFO.TRANSFER_NO, TMP_JOB_INFO.TRAYTYPE_GB, TMP_JOB_INFO.CMD_ID,
        TMP_JOB_INFO.JOBFROM_GB, TMP_JOB_INFO.TRSTATUS_GB, TMP_JOB_INFO.JOBTYPE_GB, TMP_JOB_INFO.ASSIGNRM_NM, 
        TMP_JOB_INFO.JOBSTEP_NM, TMP_JOB_INFO.SUBJOBTYPE_NM, TMP_JOB_INFO.SOURZONE_NM, TMP_JOB_INFO.DESTZONE_NM
        FROM TB_JOB_INFO TMP_JOB_INFO WHERE TMP_JOB_INFO.SCS_CD=P_SCS_CD ORDER BY TMP_JOB_INFO.PRIORITY_ORDER ASC;
    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_JOB_INFO_GET;

/

create or replace FUNCTION "UFN_STC_LOG_INFO_GET" 
(
    P_SCS_CD        IN NVARCHAR2,
    P_LOG_NM        IN NVARCHAR2,
    P_START_DTTM    IN NVARCHAR2,
    P_END_DTTM      IN NVARCHAR2,
    P_KEY1          IN NVARCHAR2,       --sysbyte
    P_KEY2          IN NVARCHAR2,       --CEID
    P_KEY3          IN NVARCHAR2        --CarrierID
)
    RETURN SYS_REFCURSOR
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    IF P_LOG_NM='HSMS' THEN
        IF (P_KEY1 IS NULL AND P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;
        ELSIF (P_KEY1 IS NULL AND P_KEY2 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_10=P_KEY3
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;        
        ELSIF (P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_3=P_KEY1
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;        
        ELSIF (P_KEY1 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_6=P_KEY2
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;
        ELSIF P_KEY1 IS NULL THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_6=P_KEY2 AND TMP_UNITED_LOG_INFO.COL_10=P_KEY3 
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;        
        ELSIF P_KEY2 IS NULL THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_3=P_KEY1 AND TMP_UNITED_LOG_INFO.COL_10=P_KEY3 
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;                
        ELSIF P_KEY3 IS NULL THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_3=P_KEY1 AND TMP_UNITED_LOG_INFO.COL_6=P_KEY2 
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;
        ELSE
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_3=P_KEY1 AND TMP_UNITED_LOG_INFO.COL_6=P_KEY2 AND TMP_UNITED_LOG_INFO.COL_10=P_KEY3
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;        
        END IF;
    ELSIF P_LOG_NM='BCR' THEN
        IF (P_KEY1 IS NULL AND P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC; 
        ELSIF (P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_1=P_KEY1
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;          
        END IF;
    ELSIF P_LOG_NM='TRANSFER' THEN
        IF (P_KEY1 IS NULL AND P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC; 
        ELSIF (P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_5=P_KEY1
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;          
        END IF;
    ELSIF P_LOG_NM='OPERATOR' THEN
        IF (P_KEY1 IS NULL AND P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;
        ELSIF (P_KEY1 IS NULL AND P_KEY2 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_2=P_KEY3
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;        
        ELSIF (P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_4=P_KEY1
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;        
        ELSIF (P_KEY1 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_7=P_KEY2
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;
        ELSIF P_KEY1 IS NULL THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_7=P_KEY2 AND TMP_UNITED_LOG_INFO.COL_2=P_KEY3 
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;        
        ELSIF P_KEY2 IS NULL THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_4=P_KEY1 AND TMP_UNITED_LOG_INFO.COL_2=P_KEY3 
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;                
        ELSIF P_KEY3 IS NULL THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_4=P_KEY1 AND TMP_UNITED_LOG_INFO.COL_7=P_KEY2 
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;
        ELSE
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO 
                WHERE TMP_UNITED_LOG_INFO.RECODE_DTTM BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_4=P_KEY1 AND TMP_UNITED_LOG_INFO.COL_7=P_KEY2 AND TMP_UNITED_LOG_INFO.COL_2=P_KEY3
                ORDER BY TMP_UNITED_LOG_INFO.RECODE_DTTM DESC;        
        END IF;    

    ELSE
        IF (P_KEY1 IS NULL AND P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO
                WHERE TMP_UNITED_LOG_INFO.COL_6 BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                ORDER BY TMP_UNITED_LOG_INFO.COL_6 DESC;
        ELSIF (P_KEY2 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO
                WHERE TMP_UNITED_LOG_INFO.COL_6 BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_1=P_KEY1
                ORDER BY TMP_UNITED_LOG_INFO.COL_6 DESC;
        ELSIF (P_KEY1 IS NULL AND P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO
                WHERE TMP_UNITED_LOG_INFO.COL_6 BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_2=P_KEY2
                ORDER BY TMP_UNITED_LOG_INFO.COL_6 DESC;
        ELSIF (P_KEY3 IS NULL) THEN
            OPEN TMP_DATA FOR
            SELECT TMP_UNITED_LOG_INFO.SCS_CD, TMP_UNITED_LOG_INFO.LOG_NM, TMP_UNITED_LOG_INFO.RECODE_DTTM, TMP_UNITED_LOG_INFO.COL_1, TMP_UNITED_LOG_INFO.COL_2,
                TMP_UNITED_LOG_INFO.COL_3, TMP_UNITED_LOG_INFO.COL_4, TMP_UNITED_LOG_INFO.COL_5, TMP_UNITED_LOG_INFO.COL_6,
                TMP_UNITED_LOG_INFO.COL_7, TMP_UNITED_LOG_INFO.COL_8, TMP_UNITED_LOG_INFO.COL_9, TMP_UNITED_LOG_INFO.COL_10,
                TMP_UNITED_LOG_INFO.COL_11, TMP_UNITED_LOG_INFO.COL_12, TMP_UNITED_LOG_INFO.COL_13, TMP_UNITED_LOG_INFO.HIST_SECS2
                FROM TB_UNITED_LOG_INFO TMP_UNITED_LOG_INFO
                WHERE TMP_UNITED_LOG_INFO.COL_6 BETWEEN P_START_DTTM AND P_END_DTTM AND TMP_UNITED_LOG_INFO.SCS_CD=P_SCS_CD AND TMP_UNITED_LOG_INFO.LOG_NM=P_LOG_NM
                    AND TMP_UNITED_LOG_INFO.COL_2=P_KEY2 AND TMP_UNITED_LOG_INFO.COL_1=P_KEY1
                ORDER BY TMP_UNITED_LOG_INFO.COL_6 DESC;
        END IF;
    END IF;

    RETURN TMP_DATA;
    CLOSE TMP_DATA;

END UFN_STC_LOG_INFO_GET;

/

create or replace FUNCTION "UFN_STC_PIO_INFO_GET" 
(
    P_SCS_CD    IN NVARCHAR2
)
    RETURN SYS_REFCURSOR
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_PIO_INFO.SCS_CD, TMP_PIO_INFO.MODULE_NM, TMP_PIO_INFO.DIRECTION_GB, TMP_PIO_INFO.DATA_VAL
        FROM TB_PIO_INFO TMP_PIO_INFO WHERE TMP_PIO_INFO.SCS_CD = P_SCS_CD;
    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_PIO_INFO_GET;


/

create or replace FUNCTION "UFN_STC_PLC_INFO_GET" 
(
    P_SCS_CD        IN NVARCHAR2
)
    RETURN SYS_REFCURSOR 
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_PLC_INFO.PLC_CD, TMP_PLC_INFO.PLC_IP, TMP_PLC_INFO.PLC_STAT, TMP_PLC_INFO.EVENTTIME_DTTM
        FROM TB_PLC_INFO TMP_PLC_INFO WHERE TMP_PLC_INFO.SCS_CD=P_SCS_CD ORDER BY TMP_PLC_INFO.PLC_NO ASC;
    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_PLC_INFO_GET;

/

create or replace FUNCTION "UFN_STC_SHELF_INFO_GET" 
(
    P_SCS_CD    IN NVARCHAR2,
    P_BANK      IN NVARCHAR2
)
    RETURN SYS_REFCURSOR   
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_SHELF_INFO.SCS_CD, TMP_SHELF_INFO.CARRIER_LOC, TMP_SHELF_INFO.ZONE_NM, TMP_SHELF_INFO.EXIST_GB, TMP_SHELF_INFO.CARRIER_ID,
        TMP_SHELF_INFO.USE_STAT, TMP_SHELF_INFO.SHELFSIZE_GB, TMP_SHELF_INFO.STATUS_GB, TMP_SHELF_INFO.DEADZONE_STAT, TMP_SHELF_INFO.INSTALL_DTTM, TMP_SHELF_INFO.FLOOR_NM,
        TMP_SHELF_INFO.MEMO_GB,TMP_SHELF_INFO.FIRE_GB
        FROM TB_SHELF_INFO TMP_SHELF_INFO WHERE TMP_SHELF_INFO.CARRIER_LOC LIKE P_BANK||'%' AND TMP_SHELF_INFO.SCS_CD=P_SCS_CD ORDER BY CARRIER_LOC ASC;
    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_SHELF_INFO_GET;

/
create or replace FUNCTION "UFN_STC_TERMINAL_MSG_GET" 
(
    P_SCS_CD        IN NVARCHAR2
)
    RETURN SYS_REFCURSOR
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_TB_HIST_TERMINAL_MSG.SCS_CD, TMP_TB_HIST_TERMINAL_MSG.TID_ID, TMP_TB_HIST_TERMINAL_MSG.TCODE_CD,
        TMP_TB_HIST_TERMINAL_MSG.TEXT_NM, TMP_TB_HIST_TERMINAL_MSG.EVENTTIME_DTTM
        FROM TB_HIST_TERMINAL_MSG TMP_TB_HIST_TERMINAL_MSG
        WHERE TMP_TB_HIST_TERMINAL_MSG.SCS_CD=P_SCS_CD 
        ORDER BY TMP_TB_HIST_TERMINAL_MSG.EVENTTIME_DTTM DESC;

    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_TERMINAL_MSG_GET;


/

create or replace FUNCTION "UFN_STC_USER_INFO_GET" 
(
    P_SCS_CD    IN NVARCHAR2
)
    RETURN SYS_REFCURSOR
IS
    TMP_DATA SYS_REFCURSOR;
BEGIN
    OPEN TMP_DATA FOR
    SELECT TMP_USER_INFO.USER_ID, TMP_USER_INFO.USER_NM, TMP_USER_INFO.TEAM_NM, TMP_USER_INFO.PASSWORD_GB, TMP_USER_INFO.GROUP_GB, TMP_USER_INFO.USE_STAT, TMP_USER_INFO.USING_DTTM 
        FROM TB_USER_INFO TMP_USER_INFO WHERE TMP_USER_INFO.SCS_CD=P_SCS_CD;
    RETURN TMP_DATA;
    CLOSE TMP_DATA;
END UFN_STC_USER_INFO_GET;




